<?php
 namespace App\Models; use Illuminate\Database\Eloquent\Factories\HasFactory; use Illuminate\Database\Eloquent\Model; use Illuminate\Database\Eloquent\Relations\BelongsTo; class LeaveRequest extends Model { use HasFactory; public const STATUS_PENDING = 'pending'; public const STATUS_APPROVED = 'approved'; public const STATUS_REJECTED = 'rejected'; protected $fillable = [ 'employee_id', 'leave_type_id', 'start_time', 'end_time', 'status', 'processed_by_user_id', 'processed_at', 'reason', 'rejection_reason', ]; protected $casts = [ 'start_time' => 'datetime', 'end_time' => 'datetime', 'processed_at' => 'datetime', ]; public function employee(): BelongsTo { return $this->belongsTo(Employee::class); } public function leaveType(): BelongsTo { return $this->belongsTo(LeaveType::class); } public function processor(): BelongsTo { return $this->belongsTo(User::class, 'processed_by_user_id'); } public function scopePending($query) { return $query->where('status', self::STATUS_PENDING); } public function scopeApproved($query) { return $query->where('status', self::STATUS_APPROVED); } public function scopeRejected($query) { return $query->where('status', self::STATUS_REJECTED); } public function getDurationForHumansAttribute(): string { return $this->start_time->diffForHumans($this->end_time, true); } public function isPending(): bool { return $this->status === self::STATUS_PENDING; } } 