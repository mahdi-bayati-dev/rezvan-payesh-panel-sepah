<?php
 namespace App\Policies; use App\Models\AttendanceLog; use App\Models\User; use Illuminate\Auth\Access\HandlesAuthorization; use Illuminate\Auth\Access\Response; class AttendanceLogPolicy { use HandlesAuthorization; public function before(User $user, string $ability) { if ($user->hasRole('super_admin')) { return true; } } public function viewAny(User $user): bool { return $user->hasRole([ 'org-admin-l2', 'org-admin-l3']); } public function view(User $user, AttendanceLog $attendanceLog): bool { if ($user->hasRole([ 'org-admin-l2', 'org-admin-l3'])) { return true; } return $user->employee && $user->employee->id === $attendanceLog->employee_id; } public function create(User $user): bool { return false; } public function update(User $user, AttendanceLog $attendanceLog): bool { return false; } public function delete(User $user, AttendanceLog $attendanceLog): bool { return false; } public function restore(User $user, AttendanceLog $attendanceLog): bool { return false; } public function forceDelete(User $user, AttendanceLog $attendanceLog): bool { return false; } }