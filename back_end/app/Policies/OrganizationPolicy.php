<?php
 namespace App\Policies; use App\Models\Organization; use App\Models\User; use Illuminate\Auth\Access\HandlesAuthorization; use Illuminate\Auth\Access\Response; class OrganizationPolicy { use HandlesAuthorization; public function viewAny(User $user): bool { return $user->hasAnyRole(['org-admin-l2', 'org-admin-l3']); } public function view(User $user, Organization $organization): bool { $userEmployeeProfile = $user->employee; if (!$userEmployeeProfile?->organization_id) return false; $adminOrg = $userEmployeeProfile->organization; if ($user->hasRole('org-admin-l2')) { return $adminOrg->descendantsAndSelf()->where('id', $organization->id)->exists(); } if ($user->hasRole('org-admin-l3')) { return $userEmployeeProfile->organization_id === $organization->id; } return false; } public function create(User $user): bool { return false; } public function update(User $user, Organization $organization): bool { return false; } public function delete(User $user, Organization $organization): bool { return false; } public function restore(User $user, Organization $organization): bool { return false; } public function forceDelete(User $user, Organization $organization): bool { return false; } } 